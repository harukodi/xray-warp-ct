name: "Xray warp ct connecitvity check"

on:
  workflow_call:
    inputs:
      TESTS_DIRECTORY:
        required: True
        type: string
      XRAY_PATH:
        required: True
        type: string
      XRAY_UUID:
        required: true
        type: string
    secrets:
      XRAY_HOST:
        required: True

env:
  XRAY_HOST: ${{ secrets.DOMAIN_NAME }}
  XRAY_PATH: ${{ inputs.XRAY_PATH }}
  XRAY_UUID: ${{ inputs.XRAY_UUID }}

jobs:
  xray-warp-ct-connecivity-check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Start xray-warp-ct connectivity check
        run: bash ./${{ inputs.TESTS_DIRECTORY }}/client_server_test.sh
        continue-on-error: True
      - name: Upload client_config
        uses: actions/upload-artifact@v4
        with:
          name: client_config
          path: tests/client_config.json
